# ü§ñ Botnoi Chatbot - Improved Version

‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó LINE ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Botnoi Chatbot Platform

## ‚ú® ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏´‡∏•‡∏±‡∏Å

### üîç **PDF Search ‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô**
- ‡πÉ‡∏ä‡πâ **Overlapping Chunks** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≤‡∏¢
- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á **Keyword Detection** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° Botnoi
- ‡πÄ‡∏û‡∏¥‡πà‡∏° **Metadata** (‡∏´‡∏ô‡πâ‡∏≤, ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç) ‡πÉ‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
- ‡∏õ‡∏£‡∏±‡∏ö **Similarity Threshold** ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

### üñºÔ∏è **Image Processing ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô**
- **Image Preprocessing** ‡∏î‡πâ‡∏ß‡∏¢ PIL (contrast enhancement, sharpening, filtering)
- **Smart OCR** - ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
- **Image Analysis** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- **Better Error Handling** - ‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

### ‚ö° **Performance Improvements**
- **Smarter Caching** - ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î cache ‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
- **Reduced Thread Pool** - ‡∏•‡∏î‡∏à‡∏≤‡∏Å 15 ‡πÄ‡∏õ‡πá‡∏ô 10 workers
- **Better Error Recovery** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
- **Optimized Embeddings** - ‡πÉ‡∏ä‡πâ cache ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö embeddings

### üß† **AI Response Quality**
- **Improved System Prompt** - ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô
- **Better Context Handling** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ context ‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
- **Structured Responses** - ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- **Temperature Tuning** - ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 1. Clone ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
cd botnoi-chatbot-improved
pip install -r requirements.txt
```

### 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Tesseract OCR (Windows)

‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏≤‡∏Å: https://github.com/UB-Mannheim/tesseract/wiki

### 3. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Ollama

```bash
# ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Ollama ‡∏à‡∏≤‡∏Å https://ollama.ai
ollama pull qwen3:8b-q4_K_M
```

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment

```bash
cp .env.example .env
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç .env ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
```

### 5. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå PDF

‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `Using_Platform_Botnoi.pdf` ‡πÉ‡∏ô folder `data/`

```
botnoi-chatbot-improved/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ Using_Platform_Botnoi.pdf
‚îú‚îÄ‚îÄ app.py
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ .env
```

## üîß ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå

```bash
python app.py
```

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook

```bash
# ‡πÉ‡∏ä‡πâ ngrok ‡∏´‡∏£‡∏∑‡∏≠ tunneling service
ngrok http 5000
```

## üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°

| ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏° | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á |
|---------|-------------|-----------------|
| **PDF Search** | Basic chunks | Overlapping chunks + metadata |
| **Image OCR** | Simple OCR | PIL Preprocessing + Smart OCR |
| **AI Response** | Generic prompt | Structured prompt + tuning |
| **Performance** | 15 workers | 10 workers + better caching |
| **Error Handling** | Basic | Comprehensive error recovery |
| **Code Structure** | Monolithic | Modular functions |

## üéØ ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å

### üí¨ **Chat Features**
- ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Botnoi
- ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
- ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå

### üñºÔ∏è **Image Processing**
- ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (OCR)
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
- ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πâ‡∏≠‡∏¢

### üåê **Translation**
- ‡πÅ‡∏õ‡∏•‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 7 ‡∏†‡∏≤‡∏©‡∏≤
- Quick Reply buttons

### üìö **Knowledge Base**
- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å PDF
- Semantic search ‡∏î‡πâ‡∏ß‡∏¢ AI
- Context-aware responses

## üõ†Ô∏è ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

### ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
- `hi`, `hello`, `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ` - ‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢
- `help` - ‡∏î‡∏π‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- `clear` - ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- `id` - ‡∏î‡∏π User ID
- `source` - ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• PDF
- `summary [‡∏à‡∏≥‡∏ô‡∏ß‡∏ô]` - ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
- `fullhistory` - ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•
- `/en_last` - ‡πÅ‡∏õ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- `/jp_last` - ‡πÅ‡∏õ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô
- `/translate_all` - ‡πÅ‡∏õ‡∏•‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏©‡∏≤

## üîç ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### PDF Search ‡πÑ‡∏°‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF ‡πÉ‡∏ô folder `data/`
- ‡∏•‡∏≠‡∏á‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå `.index` ‡πÅ‡∏•‡∏∞ `.pkl` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö embedding model

### OCR ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Tesseract
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö path ‡πÉ‡∏ô `.env`
- ‡∏•‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô

### AI ‡∏ï‡∏≠‡∏ö‡∏ä‡πâ‡∏≤
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Ollama service
- ‡∏•‡∏î `num_predict` ‡πÉ‡∏ô code
- ‡πÄ‡∏û‡∏¥‡πà‡∏° RAM ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ model ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤

## üìà Performance Tips

### ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
```python
# ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ô app.py
MAX_WORKERS = 5  # ‡∏•‡∏î‡∏à‡∏≤‡∏Å 10
CACHE_SIZE = 30  # ‡∏•‡∏î‡∏à‡∏≤‡∏Å 50
```

### ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î Memory
```python
# ‡πÉ‡∏ä‡πâ model ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤
EMBEDDING_MODEL = "sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"
```

## üîí Security Notes

- ‡πÑ‡∏°‡πà commit `.env` file
- ‡πÉ‡∏ä‡πâ environment variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö secrets
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LINE webhook signature (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

## üìù Changelog

### v2.0 (Improved)
- ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á PDF search accuracy
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° image preprocessing (PIL-based, ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ OpenCV)
- ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á AI response quality
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° error handling
- ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á performance
- ‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Python 3.7+ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ OpenCV)

### v1.0 (Original)
- Basic PDF search
- Simple OCR
- Basic AI responses

## ü§ù Contributing

1. Fork the project
2. Create feature branch
3. Commit changes
4. Push to branch
5. Open Pull Request

## üìÑ License

MIT License - ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏¥‡∏™‡∏£‡∏∞

---

**Made with ‚ù§Ô∏è for better Botnoi Chatbot experience**